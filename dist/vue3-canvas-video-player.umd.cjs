(function(e,w){typeof exports=="object"&&typeof module<"u"?module.exports=w(require("vue")):typeof define=="function"&&define.amd?define(["vue"],w):(e=typeof globalThis<"u"?globalThis:e||self,e.Vue3CanvasVideoPlayer=w(e.Vue))})(this,function(e){"use strict";const w=s=>{const t=parseInt(s),c=Math.floor(t/3600),a=Math.floor(t%3600/60),l=t%60;return`${c<10?"0"+c:c}:${a<10?"0"+a:a}:${l<10?"0"+l:l}`},N=(s,t)=>Math.round(s*t),A=(s,t)=>s/t,F=s=>s===void 0?!1:new Intl.NumberFormat().format(s),o=e.reactive({container:{element:null,fullScreen:!1,type:"overlay",mouseDown:!1,mouseMove:!1,mouseHold:!1,resizeObserver:null},video:{element:null,src:"",canvas:null,width:0,height:0,duration:0,currentTime:0,muted:!1,volume:1,loop:!1,playbackRate:1,paused:!0,fps:0},progress:{seekWidth:0,seekTotal:0,bufferWidth:0},preview:{enabled:!1,element:null,left:0,time:"00:00:00"},range:{start:0,end:0,left:0,width:0,enabled:!1},bbox:{data:{},borderSize:1,borderColor:"rgba(255, 0, 0, 0.5)",fillColor:"rgba(0, 0, 255, 0.5)",enabled:!1},message:{time:1e3,visible:!1,text:""},block:{text:"Video file has not been loaded"}});let R=!1;function T(){const s=e.computed(()=>o.range.start>0&&o.range.end>0),t=e.computed(()=>o.video.fps>0),c=e.computed(()=>Object.keys(o.bbox.data).length>0),a=()=>{const{video:{element:n,canvas:r,width:i,height:b,duration:u,fps:v},range:{start:M}}=o,k=r.getContext("2d");r.width=i,r.height=b,n.loop=o.video.loop,s.value&&(n.currentTime=M),n.paused&&(o.video.paused=!0,n.pause());const P=()=>{const{video:{loop:W},range:{enabled:D,start:U,end:G},bbox:{data:dt,fillColor:it,borderSize:z,borderColor:ct,enabled:ft}}=o;k.drawImage(n,0,0,i,b);let j=o.video.currentTime=n.currentTime;if(s.value&&D?(n.currentTime>=G&&(W?n.currentTime=U:(n.currentTime=G,n.pause(),o.video.paused=!0)),o.progress.seekWidth=((j-U)/(G-U)*100).toFixed(10),o.progress.bufferWidth=100):(n.ended&&W&&(j=0),o.progress.seekWidth=(j/u*100).toFixed(10),n.buffered.length>0&&(o.progress.bufferWidth=n.buffered.end(n.buffered.length-1)/u*100)),t.value&&c.value&&ft){const pt=N(j,v),$=dt[pt];if($&&$.length===4){const Z=$[0],X=$[1],ee=$[2]-$[0],te=$[3]-$[1];k.fillStyle=it,k.fillRect(Z,X,ee,te),z&&(k.lineWidth=z,k.strokeStyle=ct,k.strokeRect(Z-z/2,X-z/2,ee+z,te+z))}}n.paused&&Math.floor(o.progress.seekWidth)===100&&(o.video.paused=!0),window.requestAnimationFrame(P)};P()},l=n=>{const{video:{element:r,duration:i,fps:b},range:{enabled:u,start:v,end:M}}=o;r.currentTime=s.value&&u?Math.max(Math.min(n,M),v):Math.max(Math.min(n,i),0);const k=s.value&&u?Math.round((r.currentTime-v)/(M-v)*100):Math.round(r.currentTime/i*100);x(`Seek ${w(r.currentTime)} ${t.value?`[${F(N(r.currentTime,b))}]`:""} (${k>0?k:100}%)`)},g=({offsetX:n})=>{const{container:{mouseDown:r},video:{element:i,duration:b},progress:{seekTotal:u},preview:{enabled:v,element:M},range:{enabled:k,start:P,end:W}}=o;if(!i)return;const D=k?n/u*(W-P)+P:n/u*b;D===1/0||isNaN(D)||(r&&l(D),M&&v&&(M.currentTime=D,o.preview.time=w(D),n<65?o.preview.left=65:n>u-65?o.preview.left=u-65:o.preview.left=n))};let V;const E=({detail:n})=>{if(n===1){const{video:{element:r,paused:i},range:{enabled:b,start:u,end:v}}=o;V=setTimeout(()=>{i?(s.value&&b&&r.currentTime===v&&(r.currentTime=u),r.play()):r.pause(),x(i?"Play":"Pause"),o.video.paused=!i},250)}else n===2&&(clearTimeout(V),J())},_=n=>{const{video:{element:r}}=o,i=Math.max(Math.min(n,1),0);r.volume=o.video.volume=i,x(`Volume ${Math.floor(i*100)}%`)},h=({offsetY:n})=>{const{container:{mouseDown:r}}=o;r&&_((100-n)/100)},f=()=>{const{video:{element:n,muted:r}}=o;n.muted=o.video.muted=!r,x(r?"Unmuted":"Muted")},m=()=>{const{video:{element:n,fps:r}}=o;t.value?l(A(N(n.currentTime,r)+1,r)):l(n.currentTime+1)},B=()=>{const{video:{element:n,fps:r}}=o;t.value?l(A(N(n.currentTime,r)-1,r)):l(n.currentTime-1)};let S;const H=n=>{const{container:{mouseDown:r}}=o;r?S=setInterval(()=>{n?m():B()},60):clearInterval(S)},K=n=>{const{video:{element:r}}=o;r.playbackRate=o.video.playbackRate=n,x(`Playback Rate x${n.toFixed(1)}`)},d=n=>{const{video:{element:r,duration:i},progress:{seekTotal:b},range:{start:u,end:v}}=o;o.range.enabled!==n&&(o.range.enabled=n,x(n?"Active range":"Inactive range")),n?(r.currentTime=u,o.range.left=0,o.range.width=b,o.progress.seekWidth=0):(r.currentTime=0,o.range.left=u/i*b,o.range.width=v/i*b-u/i*b)},O=()=>{const{video:{element:n,loop:r}}=o;n.loop=o.video.loop=!r,x(r?"Play once":"Repeat play")},p=()=>{const{bbox:{enabled:n}}=o;o.bbox.enabled=!n,x(n?"Hide bounding box":"Show bounding box")};let L;const x=n=>{const{message:r}=o,{time:i}=r;!i||(r.text=n,r.visible=!0,L&&clearTimeout(L),L=setTimeout(()=>{r.visible=!1},i))},J=()=>{const{container:{element:n}}=o;document.fullscreenElement?document.exitFullscreen():n.requestFullscreen()},Q=({altKey:n,ctrlKey:r,key:i})=>{const{video:{element:b,paused:u,volume:v,fps:M}}=o;if(n&&r){if(i==="g"&&t.value){const k=window.prompt("Go to frame number",N(b.currentTime,M));u&&b.pause(),b.currentTime=A(k,M)}i==="ArrowUp"&&_(v+.05),i==="ArrowDown"&&_(v-.05),i==="ArrowLeft"&&B(),i==="ArrowRight"&&m()}},Y=()=>{o.container.fullScreen=Boolean(document.fullscreenElement),x(`${o.container.fullScreen?"Full":"Normal"} screen`)},st=()=>{const{container:{element:n},range:{enabled:r},preview:{enabled:i}}=o;o.progress.seekTotal=n.offsetWidth,s.value&&r&&d(!0),i&&(o.preview.left=0)};let q;const lt=()=>{q&&clearTimeout(q),o.container.mouseMove=!0,!o.container.mouseHold&&(q=setTimeout(()=>{o.container.mouseMove=!1},2e3))};return e.onMounted(()=>{R||(window.addEventListener("keydown",Q),document.addEventListener("fullscreenchange",Y),setTimeout(()=>{o.container.resizeObserver=new ResizeObserver(st),o.container.resizeObserver.observe(o.container.element)},300),R=!0)}),e.onUnmounted(()=>{!R||(o.container.resizeObserver.unobserve(o.container.element),window.removeEventListener("keydown",Q),document.removeEventListener("fullscreenchange",Y),R=!1)}),{data:o,initialVideo:a,setVideoSeek:g,toggleVideoPlay:E,toggleVideoMute:f,changeVideoVolume:h,changeVideoFrame:H,setVideoPlaybackRate:K,setVideoRange:d,toggleVideoLoop:O,toggleVideoBbox:p,toggleFullScreen:J,setMessage:x,handleContainerMouseMove:lt}}const mt="",C=(s,t)=>{const c=s.__vccOpts||s;for(const[a,l]of t)c[a]=l;return c},I=s=>(e.pushScopeId("data-v-05360fd3"),s=s(),e.popScopeId(),s),oe={class:"cvp-header"},ne=I(()=>e.createElementVNode("span",{style:{opacity:"0.5"}}," / ",-1)),ae={key:0},re=I(()=>e.createElementVNode("span",{style:{opacity:"0.5"}}," / ",-1)),se=I(()=>e.createElementVNode("span",{style:{opacity:"0.5"}}," / ",-1)),le={key:0},de=I(()=>e.createElementVNode("span",{style:{opacity:"0.5"}}," / ",-1)),ie=C({__name:"Header",setup(s){const{data:t}=T(),c=e.computed(()=>t.range.start>0&&t.range.end>0),a=e.computed(()=>t.video.fps>0);return(l,g)=>(e.openBlock(),e.createElementBlock("div",oe,[e.createElementVNode("div",{class:e.normalizeClass(["cvp-information",!e.unref(t).range.enabled&&"cvp-information-active"])},[e.createElementVNode("span",null,e.toDisplayString(e.unref(w)(e.unref(t).video.currentTime)),1),ne,e.createElementVNode("span",null,e.toDisplayString(e.unref(w)(e.unref(t).video.duration)),1),e.unref(a)?(e.openBlock(),e.createElementBlock("span",ae,[e.createElementVNode("span",null," [ "+e.toDisplayString(e.unref(F)(e.unref(N)(e.unref(t).video.currentTime,e.unref(t).video.fps))),1),re,e.createElementVNode("span",null,e.toDisplayString(e.unref(F)(e.unref(N)(e.unref(t).video.duration,e.unref(t).video.fps)))+" ]",1)])):e.createCommentVNode("",!0)],2),e.unref(c)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["cvp-information",e.unref(t).range.enabled&&"cvp-information-active"])},[e.createElementVNode("span",null,e.toDisplayString(e.unref(w)(e.unref(t).video.currentTime)),1),se,e.createElementVNode("span",null,e.toDisplayString(e.unref(w)(e.unref(t).range.end)),1),e.unref(a)?(e.openBlock(),e.createElementBlock("span",le,[e.createElementVNode("span",null," [ "+e.toDisplayString(e.unref(F)(e.unref(N)(e.unref(t).video.currentTime,e.unref(t).video.fps))),1),de,e.createElementVNode("span",null,e.toDisplayString(e.unref(F)(e.unref(N)(e.unref(t).range.end,e.unref(t).video.fps)))+" ]",1)])):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0)]))}},[["__scopeId","data-v-05360fd3"]]),ht="",ce={class:"cvp-main"},fe=["src","muted","autoplay"],pe=C({__name:"Main",props:{src:{type:String,default:!1,required:!0},muted:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1}},emits:["loadedmetadata","play","pause","timeupdate","volumechange","error"],setup(s,{emit:t}){const c=s,a=e.ref(null),l=e.ref(null),{data:g,initialVideo:V,toggleVideoPlay:E}=T(),_=h=>{Object.assign(g,{video:{...g.video,element:a.value,canvas:l.value,width:a.value.videoWidth,height:a.value.videoHeight,duration:a.value.duration,paused:!(c.muted===!0&&c.autoplay===!0)}}),V(),t("loadedmetadata",h)};return(h,f)=>(e.openBlock(),e.createElementBlock("div",ce,[e.createElementVNode("video",{class:"cvp-video",ref_key:"video",ref:a,src:s.src,muted:s.muted,autoplay:s.autoplay,onLoadedmetadata:f[0]||(f[0]=m=>_(m)),onPlay:f[1]||(f[1]=m=>t("play",m)),onPause:f[2]||(f[2]=m=>t("pause",m)),onTimeupdate:f[3]||(f[3]=m=>t("timeupdate",m)),onVolumechange:f[4]||(f[4]=m=>t("volumechange",m)),onError:f[5]||(f[5]=m=>t("error",m))},null,40,fe),e.createElementVNode("canvas",{class:"cvp-canvas",ref_key:"canvas",ref:l,onClick:f[6]||(f[6]=(...m)=>e.unref(E)&&e.unref(E)(...m))},null,512)]))}},[["__scopeId","data-v-aa93fbd6"]]),gt="",me={class:"cvp-progress"},_e={class:"cvp-progress-drag"},he=["src"],ue={class:"cvp-progress-preview-time"},ge=C({__name:"Progress",setup(s){const t=e.ref(null),c=e.ref(null),{data:a,setVideoSeek:l}=T(),g=e.computed(()=>a.range.start>0&&a.range.end>0),V=()=>{setTimeout(()=>{const{video:{width:E,height:_},preview:{enabled:h}}=a;if(!h)return;const f=c.value.getContext("2d"),m=E*.3,B=_*.3;c.value.width=m,c.value.height=B,Object.assign(a,{preview:{...a.preview,element:t.value}});const S=()=>{!t.value||(f.imageSmoothingEnabled=!0,f.drawImage(t.value,0,0,m,B),window.requestAnimationFrame(S))};S()},100)};return(E,_)=>(e.openBlock(),e.createElementBlock("div",me,[e.createElementVNode("div",_e,[e.createElementVNode("div",{class:"cvp-progress-area",onMousedown:_[0]||(_[0]=e.withModifiers(h=>{e.unref(a).container.mouseDown=!0,e.unref(l)(h)},["self"])),onMousemove:_[1]||(_[1]=(...h)=>e.unref(l)&&e.unref(l)(...h)),onMouseup:_[2]||(_[2]=h=>e.unref(a).container.mouseDown=!1),onMouseleave:_[3]||(_[3]=h=>e.unref(a).container.mouseDown=!1)},[e.createElementVNode("div",{class:"cvp-progress-buffer",style:e.normalizeStyle({width:`${e.unref(a).progress.bufferWidth}%`})},null,4),e.createElementVNode("div",{class:"cvp-progress-bar",style:e.normalizeStyle({width:`${e.unref(a).progress.seekWidth}%`})},null,4),e.unref(g)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"cvp-progress-range",style:e.normalizeStyle({left:`${e.unref(a).range.left}px`,width:`${e.unref(a).range.width}px`})},null,4)):e.createCommentVNode("",!0)],32)]),e.unref(a).preview.enabled?(e.openBlock(),e.createElementBlock("div",{key:0,class:"cvp-progress-preview",style:e.normalizeStyle({left:`${e.unref(a).preview.left}px`})},[e.createElementVNode("video",{class:"cvp-progress-preview-video",ref_key:"video",ref:t,src:e.unref(a).video.src,onLoadeddata:V},null,40,he),e.createElementVNode("canvas",{class:"cvp-progress-preview-canvas",ref_key:"canvas",ref:c},null,512),e.createElementVNode("div",ue,e.toDisplayString(e.unref(a).preview.time),1)],4)):e.createCommentVNode("",!0)]))}},[["__scopeId","data-v-9a38ced9"]]),yt="",y=s=>(e.pushScopeId("data-v-0dab554c"),s=s(),e.popScopeId(),s),be={class:"cvp-controller"},ye=["title"],ve={key:0,class:"cvp-controller-icon",viewBox:"-2 -2 28 28","stroke-width":"1",stroke:"#ffffff",fill:"none"},ke=[y(()=>e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1)),y(()=>e.createElementVNode("path",{d:"M7 4v16l13 -8z"},null,-1))],Ee={key:1,class:"cvp-controller-icon",viewBox:"0 0 24 24","stroke-width":"1",stroke:"#ffffff",fill:"none"},Ve=[y(()=>e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1)),y(()=>e.createElementVNode("rect",{x:"6",y:"5",width:"4",height:"14",rx:"1"},null,-1)),y(()=>e.createElementVNode("rect",{x:"14",y:"5",width:"4",height:"14",rx:"1"},null,-1))],we={class:"cvp-controller-volume"},xe=["title"],Me={key:0,class:"cvp-controller-icon",viewBox:"-2 -2 28 28","stroke-width":"1",stroke:"#ffffff",fill:"none"},Ne=[y(()=>e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1)),y(()=>e.createElementVNode("path",{d:"M6 15h-2a1 1 0 0 1 -1 -1v-4a1 1 0 0 1 1 -1h2l3.5 -4.5a0.8 .8 0 0 1 1.5 .5v14a0.8 .8 0 0 1 -1.5 .5l-3.5 -4.5"},null,-1)),y(()=>e.createElementVNode("path",{d:"M16 10l4 4m0 -4l-4 4"},null,-1))],Be={key:1,class:"cvp-controller-icon",viewBox:"-2 -2 28 28","stroke-width":"1",stroke:"#ffffff",fill:"none"},Se=[y(()=>e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1)),y(()=>e.createElementVNode("path",{d:"M15 8a5 5 0 0 1 0 8"},null,-1)),y(()=>e.createElementVNode("path",{d:"M17.7 5a9 9 0 0 1 0 14"},null,-1)),y(()=>e.createElementVNode("path",{d:"M6 15h-2a1 1 0 0 1 -1 -1v-4a1 1 0 0 1 1 -1h2l3.5 -4.5a0.8 .8 0 0 1 1.5 .5v14a0.8 .8 0 0 1 -1.5 .5l-3.5 -4.5"},null,-1))],$e={class:"cvp-controller-volume-drag"},Te=[y(()=>e.createElementVNode("svg",{class:"cvp-controller-icon",viewBox:"-1 -1 26 26","stroke-width":"1",stroke:"#ffffff",fill:"none"},[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElementVNode("path",{d:"M20 5v14l-12 -7z"}),e.createElementVNode("line",{x1:"4",y1:"5",x2:"4",y2:"19"})],-1))],Ce=[y(()=>e.createElementVNode("svg",{class:"cvp-controller-icon",viewBox:"-1 -1 26 26","stroke-width":"1",stroke:"#ffffff",fill:"none"},[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElementVNode("path",{d:"M4 5v14l12 -7z"}),e.createElementVNode("line",{x1:"20",y1:"5",x2:"20",y2:"19"})],-1))],De=y(()=>e.createElementVNode("div",{style:{flex:"1"}},null,-1)),ze={class:"cvp-controller-playback-rate"},Fe={class:"cvp-controller-playback-rate-text",title:"Playback rate"},He={class:"cvp-controller-playback-rate-list"},Pe={class:"cvp-controller-playback-rate-item"},Re=["onClick"],Ie=["title"],Oe={key:0,class:"cvp-controller-icon",viewBox:"-4 -4 32 32","stroke-width":"1",stroke:"#ffffff",fill:"none"},Le=[e.createStaticVNode('<path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-0dab554c></path><path d="M3 12h7l-3 -3m0 6l3 -3" data-v-0dab554c></path><path d="M21 12h-7l3 -3m0 6l-3 -3" data-v-0dab554c></path><path d="M9 6v-3h6v3" data-v-0dab554c></path><path d="M9 18v3h6v-3" data-v-0dab554c></path>',5)],We={key:1,class:"cvp-controller-icon",viewBox:"-4 -4 32 32","stroke-width":"1",stroke:"#ffffff",fill:"none"},je=[e.createStaticVNode('<path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-0dab554c></path><path d="M10 12h-7l3 -3m0 6l-3 -3" data-v-0dab554c></path><path d="M14 12h7l-3 -3m0 6l3 -3" data-v-0dab554c></path><path d="M3 6v-3h18v3" data-v-0dab554c></path><path d="M3 18v3h18v-3" data-v-0dab554c></path>',5)],Ae=["title"],qe=[y(()=>e.createElementVNode("svg",{class:"cvp-controller-icon",viewBox:"-4 -4 32 32","stroke-width":"1.5",stroke:"#ffffff",fill:"none"},[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElementVNode("path",{d:"M4 12v-3a3 3 0 0 1 3 -3h13m-3 -3l3 3l-3 3"}),e.createElementVNode("path",{d:"M20 12v3a3 3 0 0 1 -3 3h-13m3 3l-3 -3l3 -3"})],-1))],Ue=["title"],Ge=[e.createStaticVNode('<svg class="cvp-controller-icon" viewBox="-4 -4 32 32" stroke-width="1" stroke="#ffffff" fill="none" data-v-0dab554c><path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-0dab554c></path><circle cx="5" cy="5" r="2" data-v-0dab554c></circle><circle cx="19" cy="5" r="2" data-v-0dab554c></circle><circle cx="5" cy="19" r="2" data-v-0dab554c></circle><circle cx="19" cy="19" r="2" data-v-0dab554c></circle><line x1="5" y1="7" x2="5" y2="17" data-v-0dab554c></line><line x1="7" y1="5" x2="17" y2="5" data-v-0dab554c></line><line x1="7" y1="19" x2="17" y2="19" data-v-0dab554c></line><line x1="19" y1="7" x2="19" y2="17" data-v-0dab554c></line></svg>',1)],Ke=["title"],Je={key:0,class:"cvp-controller-icon",viewBox:"0 0 24 24","stroke-width":"1",stroke:"#ffffff",fill:"none"},Qe=[e.createStaticVNode('<path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-0dab554c></path><path d="M15 19v-2a2 2 0 0 1 2 -2h2" data-v-0dab554c></path><path d="M15 5v2a2 2 0 0 0 2 2h2" data-v-0dab554c></path><path d="M5 15h2a2 2 0 0 1 2 2v2" data-v-0dab554c></path><path d="M5 9h2a2 2 0 0 0 2 -2v-2" data-v-0dab554c></path>',5)],Ye={key:1,class:"cvp-controller-icon",viewBox:"-2 -2 28 28","stroke-width":"1",stroke:"#ffffff",fill:"none"},Ze=[e.createStaticVNode('<path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-0dab554c></path><path d="M4 8v-2a2 2 0 0 1 2 -2h2" data-v-0dab554c></path><path d="M4 16v2a2 2 0 0 0 2 2h2" data-v-0dab554c></path><path d="M16 4h2a2 2 0 0 1 2 2v2" data-v-0dab554c></path><path d="M16 20h2a2 2 0 0 0 2 -2v-2" data-v-0dab554c></path>',5)],Xe=C({__name:"Controller",setup(s){const{data:t,toggleVideoPlay:c,toggleVideoMute:a,changeVideoVolume:l,changeVideoFrame:g,setVideoPlaybackRate:V,setVideoRange:E,toggleVideoLoop:_,toggleVideoBbox:h,toggleFullScreen:f}=T(),m=e.computed(()=>t.range.start>0&&t.range.end>0),B=e.computed(()=>t.video.fps>0),S=e.computed(()=>Object.keys(t.bbox.data).length>0),H=()=>{E(!t.range.enabled)};return(K,d)=>{var O;return e.openBlock(),e.createElementBlock("div",be,[e.createElementVNode("button",{class:"cvp-controller-button",title:e.unref(t).video.paused?"Play":"Pause",onClick:d[0]||(d[0]=(...p)=>e.unref(c)&&e.unref(c)(...p))},[e.unref(t).video.paused?(e.openBlock(),e.createElementBlock("svg",ve,ke)):(e.openBlock(),e.createElementBlock("svg",Ee,Ve))],8,ye),e.createElementVNode("div",we,[e.createElementVNode("button",{class:"cvp-controller-button",title:e.unref(t).video.muted?"Unmute":"Mute",onClick:d[1]||(d[1]=(...p)=>e.unref(a)&&e.unref(a)(...p))},[e.unref(t).video.muted?(e.openBlock(),e.createElementBlock("svg",Me,Ne)):(e.openBlock(),e.createElementBlock("svg",Be,Se))],8,xe),e.createElementVNode("div",$e,[e.createElementVNode("div",{class:"cvp-controller-volume-area",onMousedown:d[2]||(d[2]=e.withModifiers(p=>{e.unref(t).container.mouseDown=!0,e.unref(l)(p)},["self"])),onMousemove:d[3]||(d[3]=(...p)=>e.unref(l)&&e.unref(l)(...p)),onMouseup:d[4]||(d[4]=p=>e.unref(t).container.mouseDown=!1),onMouseleave:d[5]||(d[5]=p=>e.unref(t).container.mouseDown=!1)},[e.createElementVNode("div",{class:"cvp-controller-volume-bar",style:e.normalizeStyle({height:`${e.unref(t).video.volume*100}%`})},null,4)],32)])]),e.createElementVNode("button",{class:"cvp-controller-button",title:"Backward",onMousedown:d[6]||(d[6]=p=>{e.unref(t).container.mouseDown=!0,e.unref(g)(!1)}),onMouseup:d[7]||(d[7]=p=>{e.unref(t).container.mouseDown=!1,e.unref(g)(!1)})},Te,32),e.createElementVNode("button",{class:"cvp-controller-button",title:"Forward",onMousedown:d[8]||(d[8]=p=>{e.unref(t).container.mouseDown=!0,e.unref(g)(!0)}),onMouseup:d[9]||(d[9]=p=>{e.unref(t).container.mouseDown=!1,e.unref(g)(!0)})},Ce,32),De,e.createElementVNode("div",ze,[e.createElementVNode("div",Fe,"x"+e.toDisplayString(((O=e.unref(t).video.playbackRate)==null?void 0:O.toFixed(1))||"1.0"),1),e.createElementVNode("ul",He,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList([.1,.5,1,1.5,2,5],p=>(e.openBlock(),e.createElementBlock("li",Pe,[e.createElementVNode("button",{class:"cvp-controller-playback-rate-button",onClick:L=>e.unref(V)(p)},e.toDisplayString(p.toFixed(1)),9,Re)]))),256))])]),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:e.normalizeClass(["cvp-controller-button",e.unref(t).range.enabled&&"cvp-controller-button-active"]),title:e.unref(t).range.enabled?"Reset range":"Set range",onClick:H},[e.unref(t).range.enabled?(e.openBlock(),e.createElementBlock("svg",Oe,Le)):(e.openBlock(),e.createElementBlock("svg",We,je))],10,Ie)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:e.normalizeClass(["cvp-controller-button",e.unref(t).video.loop&&"cvp-controller-button-active"]),title:e.unref(t).video.loop?"Play once":"Repeat play",onClick:d[10]||(d[10]=(...p)=>e.unref(_)&&e.unref(_)(...p))},qe,10,Ae),e.unref(B)&&e.unref(S)?(e.openBlock(),e.createElementBlock("button",{key:1,class:e.normalizeClass(["cvp-controller-button",e.unref(t).bbox.enabled&&"cvp-controller-button-active"]),title:e.unref(t).bbox.enabled?"Hide bounding box":"Show bounding box",onClick:d[11]||(d[11]=(...p)=>e.unref(h)&&e.unref(h)(...p))},Ge,10,Ue)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"cvp-controller-button",title:e.unref(t).container.fullScreen?"Normal screen":"Full screen",onClick:d[12]||(d[12]=(...p)=>e.unref(f)&&e.unref(f)(...p))},[e.unref(t).container.fullScreen?(e.openBlock(),e.createElementBlock("svg",Je,Qe)):(e.openBlock(),e.createElementBlock("svg",Ye,Ze))],8,Ke)])}}},[["__scopeId","data-v-0dab554c"]]),Lt="",et=C({__name:"index",setup(s){const{data:t,handleContainerMouseMove:c}=T();return(a,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["cvp-footer",e.unref(t).container.mouseMove&&"cvp-footer-active"]),onMouseenter:l[0]||(l[0]=g=>e.unref(t).container.mouseHold=!0),onMouseleave:l[1]||(l[1]=g=>{e.unref(t).container.mouseHold=!1,e.unref(c)()})},[e.createVNode(ge),e.createVNode(Xe)],34))}},[["__scopeId","data-v-989de2c1"]]),jt="",tt={class:"cvp-message"},ot=["innerHTML"],nt=C({__name:"Message",setup(s){const{data:t}=T();return(c,a)=>(e.openBlock(),e.createElementBlock("div",tt,[e.createElementVNode("div",{class:e.normalizeClass(["cvp-message-text",e.unref(t).message.visible?"cvp-message-text-show":"cvp-message-text-hide"]),innerHTML:e.unref(t).message.text},null,10,ot)]))}},[["__scopeId","data-v-1ecb3b3a"]]),qt="",at=["data-dark-mode","data-type"],rt={key:0,class:"cvp-block"};return C({__name:"Vue3CanvasVideoPlayer",props:{src:{type:String,default:"",required:!0},muted:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},range:{type:Array,validator:s=>!s.length||s.length===2&&s.every(t=>typeof t=="number"),default:()=>[0,0]},fps:{type:Number,default:0},bbox:{type:Object,default:()=>({data:{},borderSize:1,borderColor:"rgba(255, 0, 0, 0.5)",fillColor:"rgba(0, 0, 255, 0.5)"})},type:{type:String,default:"overlay"},messageTime:{type:Number,default:1e3},preview:{type:Boolean,default:!1},darkMode:{type:Boolean,default:!0}},setup(s){const t=s,c=e.ref(null),{data:a,setVideoRange:l,handleContainerMouseMove:g}=T();return e.watch(()=>t,({src:V,muted:E,loop:_,range:h,fps:f,bbox:m,type:B,messageTime:S,preview:H})=>{Object.assign(a.container,{type:B}),Object.assign(a.video,{src:V,muted:E,loop:_,fps:f}),Object.assign(a.preview,{enabled:H}),Object.assign(a.range,{start:h[0],end:h[1]}),Object.assign(a.bbox,{...m}),Object.assign(a.message,{time:S}),a.range.start&&a.range.end&&l(!0),Object.keys(a.bbox.data).length&&(a.bbox.enabled=!0)},{deep:!0}),e.onMounted(()=>{Object.assign(a,{container:{...a.container,element:c.value}}),a.container.type==="overlay"&&a.container.element.addEventListener("mousemove",g)}),e.onBeforeUnmount(()=>{a.container.type==="overlay"&&a.container.element.removeEventListener("mousemove",g)}),(V,E)=>(e.openBlock(),e.createElementBlock("div",{id:"vue3-canvas-video-player",ref_key:"container",ref:c,"data-dark-mode":s.darkMode,"data-type":t.type},[e.createVNode(ie),e.createVNode(pe,{src:t.src,muted:t.muted,autoplay:t.autoplay},null,8,["src","muted","autoplay"]),e.createVNode(et),e.createVNode(nt),t.src.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",rt,e.toDisplayString(e.unref(a).block.text),1))],8,at))}},[["__scopeId","data-v-5281f359"]])});
